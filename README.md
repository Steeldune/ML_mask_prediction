This is the implementation of both a mask prediction netowrk and a mask generation algorithm